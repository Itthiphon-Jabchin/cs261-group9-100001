<!DOCTYPE html>
<html lang="th"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô</title>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap"
          rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Inria+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>

<div class="navbar">
    <div class="logo">VolunteeU</div>
    <div class="nav-links">
        <a href="/" class="active" style="font-weight: bold;">Home</a>

        <th:block sec:authorize="hasAuthority('ROLE_STUDENT')">
            <a th:href="@{/student/applications}">Application</a>
        </th:block>

        <th:block sec:authorize="hasAuthority('ROLE_TEACHER')">
            <a th:href="@{/teacher/jobs}">Posts</a>
        </th:block>

        <th:block sec:authorize="isAuthenticated()">
            <a th:href="@{/profile}">Profile</a>


            <!-- üîî ‡∏Å‡∏£‡∏∞‡∏î‡∏¥‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
            <a th:href="@{/notifications}" class="notification-bell">
                <i data-lucide="bell"></i>
                <span class="badge" th:text="${notificationCount}" 
                th:if="${notificationCount > 0}"></span>
            </a>

            <form method="post" action="/logout" th:object="${_csrf}" style="display:inline; margin-left: 25px;">
                <input type="hidden" th:name="*{parameterName}" th:value="*{token}" />
                <button type="submit"
                        style="background:none; border:none; color:#A3062C; cursor:pointer;">Logout</button>
            </form>
        </th:block>

        <th:block sec:authorize="isAnonymous()">
            <a href="/login">Login</a>
        </th:block>
    </div>
</div>

<div class="main-content">
    <div class="application">
        <div th:if="${err}" 
            style="background-color:#ffdddd; color:#a10000; padding:10px; border-radius:8px; margin-bottom:15px;">
          <p th:text="${err}"></p>
        </div>

        <div th:if="${msg}" 
           style="background-color:#ddffdd; color:#006600; padding:10px; border-radius:8px; margin-bottom:15px;">
          <p th:text="${msg}"></p>
        </div>
        
        <div th:if="${job != null}">
            <div class="job_detail_header">
                <h1 th:text="${job.title}">Staff ‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà TU92</h1>
                <p class="job-description" th:text="${job.description}">
                    ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö
                </p>
            </div>

            <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ROLE_STUDENT ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô -->
            <div sec:authorize="hasAuthority('ROLE_STUDENT')">
                <div th:if="${alreadyApplied}">
                    <p class="status-message status-success"><b>‡∏Ñ‡∏∏‡∏ì‡∏™‡πà‡∏á‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡πâ‡∏ß</b></p>
                </div>

                <form th:if="${!alreadyApplied}" method="post" th:action="@{|/jobs/${job.id}/apply|}" th:object="${_csrf}"
                      class="application-form">
                    <input type="hidden" th:name="*{parameterName}" th:value="*{token}" />

                    <h2 class="form-section-title">Personal Detail</h2>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="fullName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" id="fullName" name="fullName" 
                                   required
                                   pattern="^[A-Za-z‡∏Å-‡πô\s]+$"
                                   title="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô"
                                   placeholder="Enter your full name" />
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="studentId">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                            <input type="text" id="studentId" name="studentId"
                                   pattern="\d{10}"
                                   title="‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 10 ‡∏´‡∏•‡∏±‡∏Å"
                                   placeholder="Enter your student ID" />
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <input type="email" id="email" name="email"  
                                   required
                                   title="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô name@email.com"
                                   placeholder="Enter your email" />
                        </div>
                        <div class="form-group">
                            <label for="phone">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="text" id="phone" name="phone"
                                   required
                                   pattern="0\d{9}"
                                   title="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ 0 ‡πÅ‡∏•‡∏∞‡∏°‡∏µ 10 ‡∏´‡∏•‡∏±‡∏Å" 
                                   placeholder="Enter your phone number" />
                        </div>
                    </div>

                    <h2 class="form-section-title">Application Question</h2>

                    <div class="form-group">
                        <label for="answerText" th:text="${job.questionPrompt}">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå:</label>
                        <textarea id="answerText" name="answerText"
                                  required
                                  minlength="1"
                                  title="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô" 
                                  placeholder="Enter your answer">
                        </textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="job_detail_btn btn-cancel"
                                onclick="history.back()">Cancel</button>
                        <button type="submit" class="job_detail_btn btn-submit">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
    </script>

    <!-- ‚úÖ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå (Teacher) -->
    <div sec:authorize="hasAuthority('ROLE_TEACHER')">
        <p class="status-message status-info"><i>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</i></p>
    </div>

    <!-- ‚úÖ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->
    <div sec:authorize="isAnonymous()">
        <p class="status-message status-info">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£</p>
    </div>

    <!-- ‚úÖ ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏á‡∏≤‡∏ô -->
    <div th:if="${job == null}">
        <p class="status-message status-error">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</p>
    </div>
</div>

<div class="footer">
    ¬© 2025 VolunteeU ‚Äî Software Project Recruitment
</div>

</body>
</html>
